CREATE DATABASE users_service;

CREATE TABLE users(
    user_id INT PRIMARY KEY AUTO_INCREMENT NOT NULL,
    user_public_id CHAR(36) UNIQUE NOT NULL,
    user_fname VARCHAR(30) NOT NULL,
    user_lname VARCHAR(30) NOT NULL,
    user_email VARCHAR(70) NOT NULL UNIQUE,
    user_country_code CHAR(5) NOT NULL,
    user_phone CHAR(15) NOT NULL,
    user_password VARCHAR(255) NULL,
    auth_app VARCHAR(20) NOT NULL,
    provider_user_id VARCHAR(100) NULL,
    user_role ENUM('user','admin') NOT NULL,
    user_status ENUM('active','inactive') NOT NULL DEFAULT 'active',
    created_at DATETIME DEFAULT CURRENT_TIMESTAMP,
    updated_at DATETIME DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
    UNIQUE(user_country_code, user_phone)
);

CREATE USER 'user_app'@'localhost'
IDENTIFIED BY 'StrongPasswordHere';

GRANT SELECT, INSERT, UPDATE, DELETE
ON users_service.*
TO 'user_app'@'localhost';

FLUSH PRIVILEGES;

SHOW GRANTS FOR 'user_app'@'localhost';
